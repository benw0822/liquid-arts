# Deployment Guide

## 1. Frontend Update (Netlify)
To update the website content:

1.  **Package the Code**: Create a zip file of the project (excluding development files).
2.  **Deploy**: Upload the zip file to Netlify Drop.

### Command to Package
Run this in your terminal (or I can run it for you):
```bash
zip -r liquid_arts_deploy.zip . -x ".git/*" ".DS_Store" ".agent/*"
```

### Steps
1.  Run the zip command.
2.  Go to [Netlify Drop](https://app.netlify.com/drop).
3.  Drag and drop `liquid_arts_deploy.zip` into the upload area.

## Alternative Deployment: Cloudflare Pages (Drag & Drop)
If you want a **Drag & Drop** experience like Netlify but without installing anything:

1.  Go to [Cloudflare Dashboard](https://dash.cloudflare.com/) and sign up/login.
2.  Go to **Workers & Pages** -> **Create Application**.
3.  Click **Pages** tab -> **Upload Assets**.
4.  Name your project (e.g., `liquid-arts`).
5.  Drag and drop your `liquid_arts_deploy.zip` (or the unzipped folder).
6.  Click **Deploy Site**.

## Alternative Deployment: Vercel
**Option A: Online (No Install) - Requires GitHub**
1.  Upload your code to a GitHub repository.
2.  Import that repository in Vercel.com.
*Note: Since you found GitHub complex, this might not be the best choice.*

**Option B: Command Line - Requires Installation**
1.  Requires installing Vercel CLI (`npm i -g vercel`).
*Note: You mentioned you don't want to install anything.*

## Recommendation: Cloudflare Pages
Since you want **"No Install"** and **"No GitHub"** (Drag & Drop), **Cloudflare Pages** is your best option. It works exactly like Netlify Drop.

## 3. Routine Update Workflow (Future Updates)
Once you are set up with **GitHub Desktop** and **Vercel**, updating your site is very easy:

1.  **I (AI) make changes** to your code.
2.  **Open GitHub Desktop**.
3.  You will see the changed files on the left.
4.  Type a short **Summary** (e.g., "Updated homepage") in the bottom left box.
5.  Click **Commit to main**.
6.  Click **Push origin** (top right).
7.  **Done!** Vercel will detect the change and automatically update your website in about 1 minute.

---

## 4. Backend Update (Supabase)
Since there are no automatic migrations, you must ensure your Supabase database has the required tables. Run the following SQL in the **Supabase SQL Editor** if you haven't already.

### Required Schema

```sql
-- 1. Bars Table (Enhanced)
create table if not exists bars (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  title text,
  name_en text,
  name_zh text,
  location text,
  vibe text,
  image text, -- Main cover image
  rating numeric,
  rating_count int default 0,
  price_level int, -- 1 to 4
  phone text,
  email text,
  address_zh text,
  address_en text,
  website_url text,
  instagram_url text,
  facebook_url text,
  google_map_url text,
  google_place_id text,
  lat numeric,
  lng numeric,
  opening_hours jsonb,
  tags text[], -- e.g. ['Speakeasy', 'Jazz']
  owner_user_id uuid references auth.users(id)
);

-- 2. Bar Images Table (Gallery)
create table if not exists bar_images (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  bar_id bigint references bars(id) on delete cascade,
  image_url text not null,
  caption text,
  display_order int default 0
);

-- 3. Articles Table
create table if not exists articles (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  title text not null,
  excerpt text,
  content text,
  cover_image text,
  published_at timestamp with time zone default now(),
  author_name text,
  author_id uuid references auth.users(id) -- Link to user who wrote it
);

-- 4. Bar-Articles Junction Table (Many-to-Many)
create table if not exists bar_articles (
  bar_id bigint references bars(id) on delete cascade,
  article_id bigint references articles(id) on delete cascade,
  primary key (bar_id, article_id)
);

-- 5. Users Profile Table (Public)
create table if not exists users (
  id uuid references auth.users(id) primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  email text,
  roles text[] default '{reader}', -- Array of roles: ['admin', 'barOwner', 'editor', 'reader']
  name text
);

-- 6. Menus Table
create table if not exists menus (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  bar_id bigint references bars(id) on delete cascade,
  title_zh text,
  title_en text,
  description_zh text,
  description_en text,
  file_url text
);

-- 7. Events Table
create table if not exists events (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  bar_id bigint references bars(id) on delete cascade,
  title_zh text,
  title_en text,
  description_zh text,
  description_en text,
  start_date_time timestamp with time zone,
  end_date_time timestamp with time zone,
  cover_image text,
  booking_url text
);

-- 8. Enable RLS
alter table bars enable row level security;
alter table bar_images enable row level security;
alter table articles enable row level security;
alter table bar_articles enable row level security;
alter table users enable row level security;
alter table menus enable row level security;
alter table events enable row level security;

-- Policies (Simple Public Read)
create policy "Public Read Bars" on bars for select using (true);
create policy "Public Read Bar Images" on bar_images for select using (true);
create policy "Public Read Articles" on articles for select using (true);
create policy "Public Read Bar Articles" on bar_articles for select using (true);
create policy "Public Read Menus" on menus for select using (true);
create policy "Public Read Events" on events for select using (true);
```

-- 9. Storage Policies (Required for Image Upload)
-- Enable RLS on objects
alter table storage.objects enable row level security;

-- Allow public read access to 'articles' bucket
create policy "Public Access"
on storage.objects for select
using ( bucket_id = 'articles' );

-- Allow authenticated users to upload to 'articles' bucket
create policy "Authenticated Upload"
on storage.objects for insert
with check ( bucket_id = 'articles' and auth.role() = 'authenticated' );

-- Allow users to update/delete their own uploads (Optional, good for management)
create policy "Owner Update"
on storage.objects for update
using ( bucket_id = 'articles' and auth.uid() = owner );

create policy "Owner Delete"
on storage.objects for delete
using ( bucket_id = 'articles' and auth.uid() = owner );
